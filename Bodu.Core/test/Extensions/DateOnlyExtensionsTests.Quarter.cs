// ---------------------------------------------------------------------------------------------------------------
// <auto-generated />
// ---------------------------------------------------------------------------------------------------------------

using System;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using Bodu.Extensions;
using System.Globalization;

namespace Bodu.Extensions
{
	public partial class DateOnlyExtensionsTests
	{

		public static IEnumerable<object[]> GetQuarterWithDefinitionTestData =>
			DateTimeExtensionsTests.QuarterTestData
				.Select(e => new object[] { e.Date, e.Definition, e.Quarter });

		[DataTestMethod]
		[DynamicData(nameof(GetQuarterWithDefinitionTestData), DynamicDataSourceType.Property)]
		public void GetQuarter_WhenUsingQuarterDefinition_ShouldReturnExpectedQuarter(DateTime inputDate, CalendarQuarterDefinition definition, int expected)
		{
			var input = DateOnly.FromDateTime(inputDate);
			int result = input.Quarter(definition);

			Assert.AreEqual(expected, result);
		}

		public static IEnumerable<object[]> GetQuarterTestData =>
			DateTimeExtensionsTests.QuarterTestData
				.Where(e => e.Definition == CalendarQuarterDefinition.JanuaryDecember)
				.Select(e => new object[] { e.Date, e.Quarter });

		[DataTestMethod]
		[DynamicData(nameof(GetQuarterTestData), typeof(DateOnlyExtensionsTests))]
		public void GetQuarter_WhenOnlyDateOnly_ShouldReturnExpectedQuarter(DateTime inputDate, int expected)
		{
			var input = DateOnly.FromDateTime(inputDate);
			int result = input.Quarter();

			Assert.AreEqual(expected, result);
		}

		public static IEnumerable<object[]> GetQuarterWithCustomProviderTestData =>
			DateTimeExtensionsTests.ValidQuarterProvider.QuarterTestData
				.Select(e => new object[] { e.Date, e.Quarter });

		[DataTestMethod]
		[DynamicData(nameof(GetQuarterWithCustomProviderTestData), DynamicDataSourceType.Property)]
		public void GetQuarter_WhenUsingValidProvider_ShouldReturnExpectedQuarter(DateTime inputDate, int expected)
		{
			var input = DateOnly.FromDateTime(inputDate);
			var provider = new DateTimeExtensionsTests.ValidQuarterProvider();
			int result = input.Quarter(provider);

			Assert.AreEqual(expected, result);
		}

		[TestMethod]
		public void GetQuarter_WhenUsingInvalidProvider_ShouldThrowExactly()
		{
			var input = new DateOnly(2024, 4, 20);
			var provider = new DateTimeExtensionsTests.InValidQuarterProvider();

			Assert.ThrowsExactly<ArgumentOutOfRangeException>(() =>
			{
				_ = input.Quarter(provider);
			});
		}

		[TestMethod]
		public void GetQuarter_WhenUsingCustomQuarterDefinitionWithoutProvider_ShouldThrowExactly()
		{
			var input = new DateOnly(2024, 4, 20);

			Assert.ThrowsExactly<InvalidOperationException>(() =>
			{
				_ = input.Quarter(CalendarQuarterDefinition.Custom);
			});
		}
	}
}